------------------------------------------------------------------------------------------------------------------------
this module implements the File Reference concept for the YAPL lexer
------------------------------------------------------------------------------------------------------------------------
module yapl.v4.examples.lexer.impl.file_reference


imports
========================================================================================================================

    from runtime.operating_system.file_system
        import FilePath, DirectoryPath


exports
========================================================================================================================

    FileReference


contains
========================================================================================================================

    --------------------------------------------------------------------------------------------------------------------
    Class definition for a YAPL file reference
    --------------------------------------------------------------------------------------------------------------------
    class FileReference

        public instance initializers
        ================================================================================================================

            ------------------------------------------------------------------------------------------------------------
            Initialize the Bundle instance
            ------------------------------------------------------------------------------------------------------------
            initialize instance
                accepts
                    _root_directory:DirectoryPath{absolute}
                    filename:FilePath
                body
                    root_directory = _root_directory
                    if filename is relative
                        relative_filename = filename
                        absolute_filename = filename.relative_from(_root_directory)
                    else
                        absolute_filename = filename
                        relative_filename = filename.relative_to(_root_directory)

        public instance properties
        ================================================================================================================

            ------------------------------------------------------------------------------------------------------------
            Our sha256, which is lazily initialized
            ------------------------------------------------------------------------------------------------------------
            property sha256:hexstring{length == 32}
                getter
                    if cached_sha256 is null
                        cached_sha256 = calculate_sha256_of_file(absolute_filename)
                    return sha256 = cached_sha256

        public instance state
        ================================================================================================================

            ------------------------------------------------------------------------------------------------------------
            The source root directory, representing ".", the top level of our name-space
            ------------------------------------------------------------------------------------------------------------
            root_directory:DirectoryPath{absolute}

            ------------------------------------------------------------------------------------------------------------
            The relative filename of the file we reference, relative to the root_directory
            ------------------------------------------------------------------------------------------------------------
            relative_filename:FilePath{relative}

            ------------------------------------------------------------------------------------------------------------
            The absolute filename of the file we reference
            ------------------------------------------------------------------------------------------------------------
            absolute_filename:FilePath{absolute}


        private instance internal values
        ================================================================================================================

            ------------------------------------------------------------------------------------------------------------
            The sha256 of the file we reference, if known
            ------------------------------------------------------------------------------------------------------------
            cached_sha256:hexstring{nullable, length == 32}
